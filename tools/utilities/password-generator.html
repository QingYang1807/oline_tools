<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>随机密码生成器</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 30px;
            padding: 25px;
            border-radius: 15px;
            background: #f8f9fa;
            border-left: 4px solid #4facfe;
        }

        .section h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.3em;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        .form-group input[type="number"],
        .form-group input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #4facfe;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .checkbox-group input[type="checkbox"] {
            margin-right: 10px;
            transform: scale(1.2);
        }

        .checkbox-group label {
            margin-bottom: 0;
            cursor: pointer;
        }

        .button {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-right: 15px;
            margin-bottom: 15px;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(79, 172, 254, 0.3);
        }

        .button.secondary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .password-display {
            background: #2c3e50;
            color: #00ff88;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            text-align: center;
            margin: 20px 0;
            word-break: break-all;
            position: relative;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .copy-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .strength-meter {
            margin: 20px 0;
        }

        .strength-bar {
            height: 8px;
            background: #e1e5e9;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .strength-fill {
            height: 100%;
            transition: width 0.3s, background-color 0.3s;
            border-radius: 4px;
        }

        .strength-text {
            font-size: 14px;
            color: #666;
            text-align: center;
        }

        .strength-weak { background: #ff4757; }
        .strength-medium { background: #ffa502; }
        .strength-strong { background: #2ed573; }
        .strength-very-strong { background: #1e90ff; }

        .history {
            max-height: 200px;
            overflow-y: auto;
        }

        .history-item {
            background: white;
            padding: 10px;
            margin: 5px 0;
            border-radius: 8px;
            border-left: 3px solid #4facfe;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }

        .rules-info {
            background: #e8f4fd;
            border: 1px solid #b3d9ff;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .rules-info h4 {
            color: #0066cc;
            margin-bottom: 10px;
        }

        .rules-info ul {
            margin-left: 20px;
            color: #555;
        }

        .rules-info li {
            margin-bottom: 5px;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .content {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🔐 随机密码生成器</h1>
            <p>生成安全、复杂的随机密码，支持自定义规则和复杂度评估</p>
        </div>

        <div class="content">
            <!-- 密码生成配置 -->
            <div class="section">
                <h3>📋 密码配置</h3>
                <div class="form-group">
                    <label for="passwordLength">密码长度:</label>
                    <input type="number" id="passwordLength" value="16" min="4" max="128">
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="useUppercase" checked>
                    <label for="useUppercase">包含大写字母 (A-Z)</label>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="useLowercase" checked>
                    <label for="useLowercase">包含小写字母 (a-z)</label>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="useNumbers" checked>
                    <label for="useNumbers">包含数字 (0-9)</label>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="useSymbols" checked>
                    <label for="useSymbols">包含特殊符号 (!@#$%^&*)</label>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="excludeSimilar">
                    <label for="excludeSimilar">排除相似字符 (0,O,1,I,l)</label>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="excludeAmbiguous">
                    <label for="excludeAmbiguous">排除易混淆字符 ({},[],(),/,\,|)</label>
                </div>

                <div class="form-group">
                    <label for="customChars">自定义字符集 (可选):</label>
                    <input type="text" id="customChars" placeholder="输入自定义字符，如: 中文、emoji等">
                </div>

                <button class="button" onclick="generatePassword()">🎲 生成密码</button>
                <button class="button secondary" onclick="generateMultiple()">📝 批量生成</button>
                <button class="button secondary" onclick="clearHistory()">🗑️ 清空历史</button>
            </div>

            <!-- 生成的密码显示 -->
            <div class="section">
                <h3>🔑 生成的密码</h3>
                <div id="passwordDisplay" class="password-display" style="display: none;">
                    <button class="copy-btn" onclick="copyPassword()">复制</button>
                    <div id="passwordText"></div>
                </div>
                
                <div class="strength-meter">
                    <div class="strength-bar">
                        <div id="strengthFill" class="strength-fill"></div>
                    </div>
                    <div id="strengthText" class="strength-text"></div>
                </div>
            </div>

            <!-- 密码历史 -->
            <div class="section">
                <h3>📚 生成历史</h3>
                <div id="passwordHistory" class="history"></div>
            </div>

            <!-- 规则说明 -->
            <div class="section">
                <h3>📖 使用说明</h3>
                <div class="rules-info">
                    <h4>密码复杂度评估标准:</h4>
                    <ul>
                        <li><strong>弱密码:</strong> 长度小于8位，或只包含单一字符类型</li>
                        <li><strong>中等密码:</strong> 长度8-12位，包含2-3种字符类型</li>
                        <li><strong>强密码:</strong> 长度12-16位，包含3-4种字符类型</li>
                        <li><strong>极强密码:</strong> 长度16位以上，包含所有字符类型</li>
                    </ul>
                    
                    <h4>安全建议:</h4>
                    <ul>
                        <li>建议密码长度至少12位</li>
                        <li>混合使用大小写字母、数字和特殊符号</li>
                        <li>避免使用个人信息（生日、姓名等）</li>
                        <li>不同账户使用不同密码</li>
                        <li>定期更换密码</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        class PasswordGenerator {
            constructor() {
                this.uppercase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
                this.lowercase = 'abcdefghijklmnopqrstuvwxyz';
                this.numbers = '0123456789';
                this.symbols = '!@#$%^&*()_+-=[]{}|;:,.<>?';
                this.similarChars = '0O1Il';
                this.ambiguousChars = '{}[]()/\\|';
                this.passwordHistory = [];
            }

            generatePassword(length, options) {
                let charset = '';
                let password = '';

                // 构建字符集
                if (options.useUppercase) charset += this.uppercase;
                if (options.useLowercase) charset += this.lowercase;
                if (options.useNumbers) charset += this.numbers;
                if (options.useSymbols) charset += this.symbols;
                if (options.customChars) charset += options.customChars;

                // 验证字符集
                if (charset.length === 0) {
                    throw new Error('请至少选择一种字符类型！');
                }

                // 排除相似字符
                if (options.excludeSimilar) {
                    charset = charset.split('').filter(char => !this.similarChars.includes(char)).join('');
                }

                // 排除易混淆字符
                if (options.excludeAmbiguous) {
                    charset = charset.split('').filter(char => !this.ambiguousChars.includes(char)).join('');
                }

                // 确保至少包含每种选中的字符类型
                if (options.useUppercase) password += this.getRandomChar(this.uppercase);
                if (options.useLowercase) password += this.getRandomChar(this.lowercase);
                if (options.useNumbers) password += this.getRandomChar(this.numbers);
                if (options.useSymbols) password += this.getRandomChar(this.symbols);

                // 填充剩余长度
                const remainingLength = length - password.length;
                for (let i = 0; i < remainingLength; i++) {
                    password += this.getRandomChar(charset);
                }

                // 打乱密码字符顺序
                return this.shuffleString(password);
            }

            getRandomChar(charset) {
                return charset.charAt(Math.floor(Math.random() * charset.length));
            }

            shuffleString(str) {
                const arr = str.split('');
                for (let i = arr.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [arr[i], arr[j]] = [arr[j], arr[i]];
                }
                return arr.join('');
            }

            evaluateStrength(password) {
                let score = 0;
                let feedback = [];

                // 长度评分
                if (password.length >= 16) score += 25;
                else if (password.length >= 12) score += 20;
                else if (password.length >= 8) score += 15;
                else score += 5;

                // 字符类型多样性评分
                let charTypes = 0;
                if (/[A-Z]/.test(password)) charTypes++;
                if (/[a-z]/.test(password)) charTypes++;
                if (/[0-9]/.test(password)) charTypes++;
                if (/[^A-Za-z0-9]/.test(password)) charTypes++;

                score += charTypes * 15;

                // 复杂度评分
                if (password.length >= 8 && charTypes >= 3) score += 20;
                if (password.length >= 12 && charTypes >= 4) score += 20;

                // 随机性评分（检查是否有重复模式）
                const uniqueChars = new Set(password).size;
                score += Math.min(20, uniqueChars * 2);

                // 确定强度等级
                let strength, color, text;
                if (score >= 80) {
                    strength = 'very-strong';
                    color = '#1e90ff';
                    text = '极强密码';
                } else if (score >= 60) {
                    strength = 'strong';
                    color = '#2ed573';
                    text = '强密码';
                } else if (score >= 40) {
                    strength = 'medium';
                    color = '#ffa502';
                    text = '中等密码';
                } else {
                    strength = 'weak';
                    color = '#ff4757';
                    text = '弱密码';
                }

                return {
                    score,
                    strength,
                    color,
                    text,
                    feedback
                };
            }
        }

        const generator = new PasswordGenerator();

        function generatePassword() {
            try {
                const length = parseInt(document.getElementById('passwordLength').value);
                const options = {
                    useUppercase: document.getElementById('useUppercase').checked,
                    useLowercase: document.getElementById('useLowercase').checked,
                    useNumbers: document.getElementById('useNumbers').checked,
                    useSymbols: document.getElementById('useSymbols').checked,
                    excludeSimilar: document.getElementById('excludeSimilar').checked,
                    excludeAmbiguous: document.getElementById('excludeAmbiguous').checked,
                    customChars: document.getElementById('customChars').value
                };

                if (length < 4 || length > 128) {
                    alert('密码长度必须在4-128位之间！');
                    return;
                }

                const password = generator.generatePassword(length, options);
                const strength = generator.evaluateStrength(password);

                // 显示密码
                document.getElementById('passwordText').textContent = password;
                document.getElementById('passwordDisplay').style.display = 'block';

                // 更新强度指示器
                document.getElementById('strengthFill').style.width = strength.score + '%';
                document.getElementById('strengthFill').style.backgroundColor = strength.color;
                document.getElementById('strengthText').textContent = `${strength.text} (${strength.score}分)`;

                // 添加到历史记录
                addToHistory(password, strength);

            } catch (error) {
                alert(error.message);
            }
        }

        function generateMultiple() {
            const count = prompt('请输入要生成的密码数量 (1-10):', '5');
            const num = parseInt(count);
            
            if (isNaN(num) || num < 1 || num > 10) {
                alert('请输入1-10之间的数字！');
                return;
            }

            for (let i = 0; i < num; i++) {
                generatePassword();
            }
        }

        function addToHistory(password, strength) {
            const historyItem = {
                password,
                strength: strength.text,
                score: strength.score,
                timestamp: new Date().toLocaleString()
            };

            generator.passwordHistory.unshift(historyItem);
            
            // 限制历史记录数量
            if (generator.passwordHistory.length > 20) {
                generator.passwordHistory = generator.passwordHistory.slice(0, 20);
            }

            updateHistoryDisplay();
        }

        function updateHistoryDisplay() {
            const historyDiv = document.getElementById('passwordHistory');
            historyDiv.innerHTML = '';

            generator.passwordHistory.forEach((item, index) => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'history-item';
                itemDiv.innerHTML = `
                    <div><strong>密码 ${index + 1}:</strong> ${item.password}</div>
                    <div style="font-size: 12px; color: #666;">
                        强度: ${item.strength} (${item.score}分) | 生成时间: ${item.timestamp}
                    </div>
                `;
                historyDiv.appendChild(itemDiv);
            });
        }

        function copyPassword() {
            const password = document.getElementById('passwordText').textContent;
            navigator.clipboard.writeText(password).then(() => {
                const btn = document.querySelector('.copy-btn');
                const originalText = btn.textContent;
                btn.textContent = '已复制!';
                setTimeout(() => {
                    btn.textContent = originalText;
                }, 2000);
            }).catch(() => {
                alert('复制失败，请手动复制密码');
            });
        }

        function clearHistory() {
            if (confirm('确定要清空所有密码历史记录吗？')) {
                generator.passwordHistory = [];
                updateHistoryDisplay();
            }
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 设置默认值
            document.getElementById('passwordLength').value = 16;
            
            // 绑定回车键生成密码
            document.getElementById('passwordLength').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    generatePassword();
                }
            });
        });
    </script>
</body>
</html>