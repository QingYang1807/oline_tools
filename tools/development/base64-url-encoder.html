<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Base64/URL ç¼–è§£ç å·¥å…· Â· ç½‘é¡µå·¥å…·ç®±</title>
  <link rel="stylesheet" href="../../assets/css/style.css">
  <meta name="color-scheme" content="light dark">
  <style>
    .encoder-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin-bottom: 32px;
    }

    .encoder-section {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 2px 8px var(--shadow);
    }

    .encoder-section h3 {
      margin: 0 0 16px 0;
      color: var(--fg);
      font-size: 1.3rem;
      font-weight: 600;
    }

    .input-group {
      margin-bottom: 16px;
    }

    .input-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: var(--fg);
    }

    .input-group textarea {
      width: 100%;
      min-height: 120px;
      padding: 12px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--panel-bg);
      color: var(--fg);
      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
      font-size: 14px;
      resize: vertical;
      transition: border-color 0.2s ease;
    }

    .input-group textarea:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }

    .button-group {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary {
      background: var(--accent);
      color: white;
      border: 1px solid var(--accent);
    }

    .btn-primary:hover {
      background: var(--accent-hover);
      border-color: var(--accent-hover);
      transform: translateY(-1px);
    }

    .btn-secondary {
      background: var(--panel-bg);
      color: var(--fg);
      border: 1px solid var(--border);
    }

    .btn-secondary:hover {
      background: var(--border);
      transform: translateY(-1px);
    }

    .btn-danger {
      background: #ef4444;
      color: white;
      border: 1px solid #ef4444;
    }

    .btn-danger:hover {
      background: #dc2626;
      border-color: #dc2626;
      transform: translateY(-1px);
    }

    .format-selector {
      margin-bottom: 16px;
    }

    .format-selector label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: var(--fg);
    }

    .format-selector select {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--panel-bg);
      color: var(--fg);
      font-size: 14px;
      cursor: pointer;
    }

    .format-selector select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }

    .result-info {
      margin-top: 16px;
      padding: 12px;
      background: var(--panel-bg);
      border-radius: 8px;
      font-size: 14px;
      color: var(--muted);
    }

    .error-message {
      color: #ef4444;
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.2);
    }

    .success-message {
      color: #10b981;
      background: rgba(16, 185, 129, 0.1);
      border: 1px solid rgba(16, 185, 129, 0.2);
    }

    .copy-btn {
      position: relative;
    }

    .copy-btn::after {
      content: 'å·²å¤åˆ¶!';
      position: absolute;
      top: -40px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--fg);
      color: var(--bg);
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 12px;
      opacity: 0;
      transition: opacity 0.2s ease;
      pointer-events: none;
      white-space: nowrap;
    }

    .copy-btn.copied::after {
      opacity: 1;
    }

    .quick-actions {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 32px;
      box-shadow: 0 2px 8px var(--shadow);
    }

    .quick-actions h3 {
      margin: 0 0 16px 0;
      color: var(--fg);
      font-size: 1.3rem;
      font-weight: 600;
    }

    .quick-actions-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
    }

    .quick-action-btn {
      padding: 12px 16px;
      background: var(--panel-bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--fg);
      text-decoration: none;
      text-align: center;
      transition: all 0.2s ease;
      font-size: 14px;
    }

    .quick-action-btn:hover {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
      transform: translateY(-1px);
    }

    @media (max-width: 768px) {
      .encoder-container {
        grid-template-columns: 1fr;
      }

      .button-group {
        flex-direction: column;
      }

      .btn {
        width: 100%;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container">
      <h1 class="site-title">ğŸ” Base64/URL ç¼–è§£ç å·¥å…·</h1>
      <p class="site-subtitle">ä¸€é”®å¤„ç†å¸¸è§ç¼–ç è§£ç éœ€æ±‚</p>
    </div>
  </header>

  <main class="container">
    <div class="quick-actions">
      <h3>å¿«é€Ÿæ“ä½œ</h3>
      <div class="quick-actions-grid">
        <button class="quick-action-btn" onclick="encodeBase64()">Base64 ç¼–ç </button>
        <button class="quick-action-btn" onclick="decodeBase64()">Base64 è§£ç </button>
        <button class="quick-action-btn" onclick="encodeUrl()">URL ç¼–ç </button>
        <button class="quick-action-btn" onclick="decodeUrl()">URL è§£ç </button>
        <button class="quick-action-btn" onclick="encodeHtml()">HTML å®ä½“ç¼–ç </button>
        <button class="quick-action-btn" onclick="decodeHtml()">HTML å®ä½“è§£ç </button>
      </div>
    </div>

    <div class="encoder-container">
      <div class="encoder-section">
        <h3>è¾“å…¥å†…å®¹</h3>
        <div class="format-selector">
          <label for="inputFormat">ç¼–ç æ ¼å¼ï¼š</label>
          <select id="inputFormat">
            <option value="text">çº¯æ–‡æœ¬</option>
            <option value="base64">Base64</option>
            <option value="url">URL ç¼–ç </option>
            <option value="html">HTML å®ä½“</option>
            <option value="hex">åå…­è¿›åˆ¶</option>
          </select>
        </div>
        <div class="input-group">
          <label for="inputText">è¾“å…¥å†…å®¹ï¼š</label>
          <textarea id="inputText" placeholder="è¯·è¾“å…¥è¦ç¼–ç æˆ–è§£ç çš„å†…å®¹..."></textarea>
        </div>
        <div class="button-group">
          <button class="btn btn-primary" onclick="encode()">
            <span>ğŸ”’</span>ç¼–ç 
          </button>
          <button class="btn btn-primary" onclick="decode()">
            <span>ğŸ”“</span>è§£ç 
          </button>
          <button class="btn btn-secondary" onclick="clearInput()">
            <span>ğŸ—‘ï¸</span>æ¸…ç©º
          </button>
        </div>
      </div>

      <div class="encoder-section">
        <h3>è¾“å‡ºç»“æœ</h3>
        <div class="format-selector">
          <label for="outputFormat">è¾“å‡ºæ ¼å¼ï¼š</label>
          <select id="outputFormat">
            <option value="text">çº¯æ–‡æœ¬</option>
            <option value="base64">Base64</option>
            <option value="url">URL ç¼–ç </option>
            <option value="html">HTML å®ä½“</option>
            <option value="hex">åå…­è¿›åˆ¶</option>
          </select>
        </div>
        <div class="input-group">
          <label for="outputText">è¾“å‡ºç»“æœï¼š</label>
          <textarea id="outputText" placeholder="ç¼–ç æˆ–è§£ç çš„ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..." readonly></textarea>
        </div>
        <div class="button-group">
          <button class="btn btn-secondary copy-btn" onclick="copyOutput()" id="copyBtn">
            <span>ğŸ“‹</span>å¤åˆ¶ç»“æœ
          </button>
          <button class="btn btn-secondary" onclick="downloadResult()">
            <span>ğŸ’¾</span>ä¸‹è½½æ–‡ä»¶
          </button>
          <button class="btn btn-danger" onclick="clearOutput()">
            <span>ğŸ—‘ï¸</span>æ¸…ç©º
          </button>
        </div>
        <div id="resultInfo" class="result-info" style="display: none;"></div>
      </div>
    </div>

    <div class="quick-actions">
      <h3>ä½¿ç”¨è¯´æ˜</h3>
      <div style="color: var(--muted); line-height: 1.6;">
        <p><strong>Base64 ç¼–ç /è§£ç ï¼š</strong>å°†äºŒè¿›åˆ¶æ•°æ®è½¬æ¢ä¸ºå¯æ‰“å°çš„ASCIIå­—ç¬¦ï¼Œå¸¸ç”¨äºå›¾ç‰‡ã€æ–‡ä»¶ç­‰æ•°æ®çš„ä¼ è¾“å’Œå­˜å‚¨ã€‚</p>
        <p><strong>URL ç¼–ç /è§£ç ï¼š</strong>å°†ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸ºURLå®‰å…¨çš„æ ¼å¼ï¼Œç¡®ä¿URLåœ¨å„ç§ç¯å¢ƒä¸‹éƒ½èƒ½æ­£ç¡®è§£æã€‚</p>
        <p><strong>HTML å®ä½“ç¼–ç /è§£ç ï¼š</strong>å°†HTMLç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸ºå®ä½“å¼•ç”¨ï¼Œé˜²æ­¢XSSæ”»å‡»å’Œç¡®ä¿HTMLæ­£ç¡®æ˜¾ç¤ºã€‚</p>
        <p><strong>åå…­è¿›åˆ¶ç¼–ç /è§£ç ï¼š</strong>å°†æ•°æ®è½¬æ¢ä¸ºåå…­è¿›åˆ¶è¡¨ç¤ºï¼Œå¸¸ç”¨äºè°ƒè¯•å’Œä½çº§æ•°æ®å¤„ç†ã€‚</p>
      </div>
    </div>
  </main>

  <footer class="site-footer">
    <div class="container">
      <span>Â© <span id="year"></span> ç½‘é¡µå·¥å…·ç®±</span>
      <span style="margin-left: 16px;">
        <a href="../../index.html" style="color: var(--muted); text-decoration: none;">â† è¿”å›é¦–é¡µ</a>
      </span>
    </div>
  </footer>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    // ç¼–ç å‡½æ•°
    function encode() {
      const input = document.getElementById('inputText').value.trim();
      const inputFormat = document.getElementById('inputFormat').value;
      const outputFormat = document.getElementById('outputFormat').value;

      if (!input) {
        showResultInfo('è¯·è¾“å…¥è¦ç¼–ç çš„å†…å®¹', 'error');
        return;
      }

      try {
        let result = '';

        // æ ¹æ®è¾“å…¥æ ¼å¼è§£æè¾“å…¥
        let decodedInput = parseInput(input, inputFormat);

        // æ ¹æ®è¾“å‡ºæ ¼å¼ç¼–ç 
        result = encodeOutput(decodedInput, outputFormat);

        document.getElementById('outputText').value = result;
        showResultInfo(`ç¼–ç æˆåŠŸï¼è¾“å…¥æ ¼å¼ï¼š${inputFormat} â†’ è¾“å‡ºæ ¼å¼ï¼š${outputFormat}`, 'success');
      } catch (error) {
        showResultInfo(`ç¼–ç å¤±è´¥ï¼š${error.message}`, 'error');
      }
    }

    // è§£ç å‡½æ•°
    function decode() {
      const input = document.getElementById('inputText').value.trim();
      const inputFormat = document.getElementById('inputFormat').value;
      const outputFormat = document.getElementById('outputFormat').value;

      if (!input) {
        showResultInfo('è¯·è¾“å…¥è¦è§£ç çš„å†…å®¹', 'error');
        return;
      }

      try {
        let result = '';

        // æ ¹æ®è¾“å…¥æ ¼å¼è§£ç 
        let decodedInput = parseInput(input, inputFormat);

        // æ ¹æ®è¾“å‡ºæ ¼å¼ç¼–ç 
        result = encodeOutput(decodedInput, outputFormat);

        document.getElementById('outputText').value = result;
        showResultInfo(`è§£ç æˆåŠŸï¼è¾“å…¥æ ¼å¼ï¼š${inputFormat} â†’ è¾“å‡ºæ ¼å¼ï¼š${outputFormat}`, 'success');
      } catch (error) {
        showResultInfo(`è§£ç å¤±è´¥ï¼š${error.message}`, 'error');
      }
    }

    // è§£æè¾“å…¥å†…å®¹
    function parseInput(input, format) {
      switch (format) {
        case 'text':
          return input;
        case 'base64':
          try {
            return atob(input);
          } catch (error) {
            throw new Error('æ— æ•ˆçš„Base64ç¼–ç ');
          }
        case 'url':
          try {
            return decodeURIComponent(input);
          } catch (error) {
            throw new Error('æ— æ•ˆçš„URLç¼–ç ');
          }
        case 'html':
          return decodeHtmlEntities(input);
        case 'hex':
          return hexToString(input);
        default:
          return input;
      }
    }

    // ç¼–ç è¾“å‡ºå†…å®¹
    function encodeOutput(input, format) {
      switch (format) {
        case 'text':
          return input;
        case 'base64':
          return btoa(input);
        case 'url':
          return encodeURIComponent(input);
        case 'html':
          return encodeHtmlEntities(input);
        case 'hex':
          return stringToHex(input);
        default:
          return input;
      }
    }

    // HTMLå®ä½“è§£ç 
    function decodeHtmlEntities(text) {
      const textarea = document.createElement('textarea');
      textarea.innerHTML = text;
      return textarea.value;
    }

    // HTMLå®ä½“ç¼–ç 
    function encodeHtmlEntities(text) {
      return text
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#39;');
    }

    // åå…­è¿›åˆ¶è½¬å­—ç¬¦ä¸²
    function hexToString(hex) {
      if (hex.startsWith('0x')) {
        hex = hex.slice(2);
      }
      if (hex.length % 2 !== 0) {
        throw new Error('æ— æ•ˆçš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²');
      }
      const bytes = new Uint8Array(hex.length / 2);
      for (let i = 0; i < hex.length; i += 2) {
        const byte = parseInt(hex.substr(i, 2), 16);
        if (isNaN(byte)) {
          throw new Error('æ— æ•ˆçš„åå…­è¿›åˆ¶å­—ç¬¦');
        }
        bytes[i / 2] = byte;
      }
      return new TextDecoder().decode(bytes);
    }

    // å­—ç¬¦ä¸²è½¬åå…­è¿›åˆ¶
    function stringToHex(text) {
      const bytes = new TextEncoder().encode(text);
      return Array.from(bytes).map(b => b.toString(16).padStart(2, '0')).join('');
    }

    // å¿«é€Ÿæ“ä½œå‡½æ•°
    function encodeBase64() {
      document.getElementById('inputFormat').value = 'text';
      document.getElementById('outputFormat').value = 'base64';
      document.getElementById('inputText').focus();
    }

    function decodeBase64() {
      document.getElementById('inputFormat').value = 'base64';
      document.getElementById('outputFormat').value = 'text';
      document.getElementById('inputText').focus();
    }

    function encodeUrl() {
      document.getElementById('inputFormat').value = 'text';
      document.getElementById('outputFormat').value = 'url';
      document.getElementById('inputText').focus();
    }

    function decodeUrl() {
      document.getElementById('inputFormat').value = 'url';
      document.getElementById('outputFormat').value = 'text';
      document.getElementById('inputText').focus();
    }

    function encodeHtml() {
      document.getElementById('inputFormat').value = 'text';
      document.getElementById('outputFormat').value = 'html';
      document.getElementById('inputText').focus();
    }

    function decodeHtml() {
      document.getElementById('inputFormat').value = 'html';
      document.getElementById('outputFormat').value = 'text';
      document.getElementById('inputText').focus();
    }

    // æ¸…ç©ºè¾“å…¥
    function clearInput() {
      document.getElementById('inputText').value = '';
      document.getElementById('inputText').focus();
    }

    // æ¸…ç©ºè¾“å‡º
    function clearOutput() {
      document.getElementById('outputText').value = '';
      document.getElementById('resultInfo').style.display = 'none';
    }

    // å¤åˆ¶è¾“å‡ºç»“æœ
    function copyOutput() {
      const output = document.getElementById('outputText').value;
      if (!output) {
        showResultInfo('æ²¡æœ‰å¯å¤åˆ¶çš„å†…å®¹', 'error');
        return;
      }

      navigator.clipboard.writeText(output).then(() => {
        const copyBtn = document.getElementById('copyBtn');
        copyBtn.classList.add('copied');
        setTimeout(() => {
          copyBtn.classList.remove('copied');
        }, 2000);
        showResultInfo('ç»“æœå·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
      }).catch(() => {
        showResultInfo('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶', 'error');
      });
    }

    // ä¸‹è½½ç»“æœ
    function downloadResult() {
      const output = document.getElementById('outputText').value;
      if (!output) {
        showResultInfo('æ²¡æœ‰å¯ä¸‹è½½çš„å†…å®¹', 'error');
        return;
      }

      const blob = new Blob([output], { type: 'text/plain;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'encoded_result.txt';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
      showResultInfo('æ–‡ä»¶å·²ä¸‹è½½', 'success');
    }

    // æ˜¾ç¤ºç»“æœä¿¡æ¯
    function showResultInfo(message, type) {
      const resultInfo = document.getElementById('resultInfo');
      resultInfo.textContent = message;
      resultInfo.className = `result-info ${type}-message`;
      resultInfo.style.display = 'block';

      setTimeout(() => {
        resultInfo.style.display = 'none';
      }, 3000);
    }

    // ç›‘å¬å›è½¦é”®
    document.getElementById('inputText').addEventListener('keydown', function(e) {
      if (e.ctrlKey && e.key === 'Enter') {
        encode();
      } else if (e.ctrlKey && e.key === 'Shift' && e.key === 'Enter') {
        decode();
      }
    });

    // è‡ªåŠ¨è°ƒæ•´textareaé«˜åº¦
    document.getElementById('inputText').addEventListener('input', function() {
      this.style.height = 'auto';
      this.style.height = Math.min(this.scrollHeight, 300) + 'px';
    });
  </script>
</body>
</html>