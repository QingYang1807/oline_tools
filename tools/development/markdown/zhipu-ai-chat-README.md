# 智谱AI对话工具 - 专业版

一个功能强大的智谱AI对话工具，支持流式输出、完整的Markdown渲染、代码高亮等专业特性。

## 📱 响应式设计 - 完美适配所有设备

本工具已经过全面的响应式优化，在任何设备上都能提供出色的使用体验！

### 支持的设备

| 设备类型 | 屏幕尺寸 | 主要优化 |
|---------|---------|---------|
| 🖥️ **PC超大屏** | >1440px | 最大宽度1600px，两侧留边，消息宽度85%限制提高可读性 |
| 💻 **PC中屏** | 1024-1440px | 充分利用宽度，完整功能展示 |
| 📱 **iPad Pro 12.9"** | 1024-1366px | 平板优化，触摸友好，接近桌面体验 |
| 📱 **iPad/平板** | 768-1023px | 适中尺寸，单手操作便捷 |
| 📱 **手机横屏** | 568-767px | 紧凑布局，内容优先，去除多余装饰 |
| 📱 **手机竖屏** | <768px | 全屏沉浸体验，iOS安全区域适配（支持刘海屏） |

### 响应式特性

- ✅ **屏幕空间充分利用**：大屏幕不再有大量空白，小屏幕全屏显示
- ✅ **自适应字体和间距**：不同设备使用最合适的尺寸
- ✅ **触摸优化**：移动端按钮最小44px，符合人体工程学
- ✅ **iOS安全区域**：完美适配iPhone刘海屏和Home指示器
- ✅ **横竖屏切换**：自动适应屏幕方向变化
- ✅ **表格横向滚动**：小屏幕上表格可以左右滑动
- ✅ **智能堆叠**：手机上设置面板自动变为垂直布局

**📖 详细说明：** 查看 [响应式设计完整文档](./zhipu-ai-chat-RESPONSIVE.md)

---

## ✨ 核心功能

### 1. 流式输出 (SSE)
- **实时生成**：支持Server-Sent Events流式输出，像ChatGPT一样逐字显示AI回复
- **打字机效果**：带闪烁光标的实时打字效果
- **停止生成**：可以随时停止AI的生成过程
- **可切换模式**：可在设置中开启/关闭流式输出

### 2. 完整的Markdown渲染
- **标题**：支持H1-H6所有级别标题
- **列表**：支持有序列表和无序列表
- **代码块**：支持多种编程语言的语法高亮
- **行内代码**：美观的行内代码样式
- **引用块**：支持blockquote引用
- **表格**：完整的表格渲染支持
- **链接**：支持超链接
- **加粗/斜体**：支持文本格式化
- **分隔线**：支持水平线

### 3. 代码高亮与复制
- **语法高亮**：使用Highlight.js自动识别并高亮100+种编程语言
- **一键复制**：每个代码块都有复制按钮
- **语言标识**：显示代码块使用的编程语言
- **暗色主题**：专业的GitHub Dark代码配色

### 4. 智能交互
- **多轮对话**：自动保持对话上下文
- **消息操作**：hover消息时显示操作按钮（复制等）
- **自动滚动**：新消息自动滚到底部
- **Enter发送**：Enter键发送，Shift+Enter换行
- **自适应输入框**：输入框高度自动调整

### 5. API Key管理
- **本地存储**：API Key保存在浏览器localStorage中
- **安全输入**：密码输入框保护API Key
- **持久化**：刷新页面设置不丢失

### 6. 模型管理
- **预设模型**：
  - GLM-4-Plus (最强大)
  - GLM-4-0520
  - GLM-4
  - GLM-4-Air (快速响应)
  - GLM-4-AirX (超快速)
  - GLM-4-Flash (闪电般速度)
- **自定义模型**：支持输入任意模型名称

### 7. 系统提示词
- **自定义角色**：可以设置AI的角色和行为
- **预设提示词**：默认为"你是一个有用的AI助手"
- **持久保存**：提示词会保存到浏览器

### 8. UI/UX特性
- **响应式设计**：完美适配PC和移动设备
- **渐变配色**：现代美观的紫色渐变主题
- **流畅动画**：消息淡入、按钮hover等动画效果
- **状态指示**：实时显示连接状态
- **美化滚动条**：优化的滚动条样式
- **流式动画**：生成中的消息有脉冲动画效果

### 9. 安全特性
- **XSS防护**：使用DOMPurify清理HTML输出
- **CORS支持**：正确处理跨域请求
- **错误处理**：完善的错误提示和处理机制

## 🚀 使用方法

### 第一步：配置设置
1. 点击右上角 **"⚙️ 设置"** 按钮
2. 输入你的智谱AI **API Key**
   - 在[智谱AI开放平台](https://open.bigmodel.cn/)获取API Key
3. 选择一个**模型**（推荐GLM-4-Plus或GLM-4-Flash）
4. （可选）修改**系统提示词**来自定义AI角色
5. （可选）开启/关闭**流式输出**（推荐开启）
6. 点击 **"💾 保存设置"**

### 第二步：开始对话
1. 在底部输入框输入你的问题
2. 按**Enter键**发送（Shift+Enter换行）
3. 观看AI实时生成回复（如果开启了流式输出）
4. 如果需要，点击 **"⏹ 停止"** 按钮停止生成

### 第三步：使用高级功能
- **复制代码**：点击代码块右上角的"📋 复制"按钮
- **复制消息**：hover到消息上，点击"📋 复制"按钮
- **清空对话**：点击右上角"🗑️ 清空对话"按钮
- **查看状态**：左上角的圆点显示连接状态（绿色=已配置，红色=未配置）

## 💡 使用技巧

### 1. 获取最佳性能
- **GLM-4-Flash**：最快，适合简单对话
- **GLM-4-Air**：平衡性能和速度
- **GLM-4-Plus**：最强大，适合复杂任务

### 2. 自定义AI角色
在系统提示词中输入：
```
你是一个专业的Python编程助手，擅长解释代码和提供最佳实践建议。
```

### 3. 流式vs非流式
- **流式输出**：实时显示，体验更好，但消耗更多资源
- **非流式输出**：等待完成后一次性显示，节省资源

### 4. 代码问答
直接问AI代码问题，它会自动使用代码块格式回复，并带语法高亮：
```
问：如何用Python读取JSON文件？
答：（AI会用代码块回复，并自动高亮）
```

## 🎯 对标功能

本工具已实现市面主流AI对话工具的核心功能：

| 功能 | 本工具 | ChatGPT | Claude |
|------|--------|---------|--------|
| 流式输出 | ✅ | ✅ | ✅ |
| Markdown渲染 | ✅ | ✅ | ✅ |
| 代码高亮 | ✅ | ✅ | ✅ |
| 代码复制 | ✅ | ✅ | ✅ |
| 多轮对话 | ✅ | ✅ | ✅ |
| 停止生成 | ✅ | ✅ | ✅ |
| 自定义角色 | ✅ | ✅ | ✅ |
| 响应式设计 | ✅ | ✅ | ✅ |

## 🔧 技术栈

- **前端框架**：纯HTML + CSS + JavaScript
- **Markdown解析**：[Marked.js](https://marked.js.org/) v11.1.1
- **代码高亮**：[Highlight.js](https://highlightjs.org/) v11.9.0
- **XSS防护**：[DOMPurify](https://github.com/cure53/DOMPurify) v3.0.6
- **API**：智谱AI开放平台 API v4
- **存储**：浏览器localStorage

## 📝 API说明

使用智谱AI开放平台的标准API：
- **端点**：`https://open.bigmodel.cn/api/paas/v4/chat/completions`
- **认证**：Bearer Token (API Key)
- **支持流式**：通过`stream: true`参数启用SSE
- **参数**：
  - `model`: 模型名称
  - `messages`: 对话历史（包括system、user、assistant）
  - `temperature`: 0.7 (创造性)
  - `stream`: true/false

## 🔒 隐私与安全

- ✅ API Key仅保存在你的浏览器本地
- ✅ 不会上传到任何第三方服务器
- ✅ 对话历史仅在内存中，刷新页面即清空
- ✅ 使用DOMPurify防止XSS攻击
- ✅ 所有通信直接连接智谱AI官方API

## 🐛 已知问题与限制

1. **对话历史**：刷新页面会丢失对话（可以后续添加持久化）
2. **文件上传**：当前版本不支持文件上传
3. **图片识别**：不支持多模态功能
4. **语音输入**：不支持语音转文字

## 🚧 未来计划

- [ ] 对话历史持久化
- [ ] 导出对话为Markdown/PDF
- [ ] 支持文件上传
- [ ] 支持多模态（图片）
- [ ] 对话历史搜索
- [ ] 对话分支管理
- [ ] 预设提示词模板库
- [ ] 深色/浅色主题切换
- [ ] 快捷键支持

## 📖 常见问题

### Q: 为什么流式输出显示乱码？
A: 可能是网络问题导致SSE数据不完整，可以尝试关闭流式输出或刷新页面。

### Q: API Key存在哪里？
A: 存储在浏览器的localStorage中，只在你的本地浏览器，不会上传。

### Q: 如何清除API Key？
A: 在设置中清空API Key输入框并保存，或者清除浏览器缓存。

### Q: 支持哪些编程语言的代码高亮？
A: Highlight.js支持190+种语言，包括Python、JavaScript、Java、C++、Go、Rust等主流语言。

### Q: 可以在移动设备上使用吗？
A: 可以！本工具完全响应式设计，支持手机和平板。

### Q: 对话历史会保存吗？
A: 当前版本不会持久化保存，刷新页面会清空。如需保存可以使用"复制"功能。

## 📞 反馈与贡献

如果你有任何问题或建议，欢迎提Issue或Pull Request！

---

**享受与AI对话的乐趣！** 🎉

