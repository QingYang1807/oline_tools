# 智谱AI对话工具 - 多模态功能升级说明

## 📋 更新概览

本次更新为智谱AI对话工具添加了**完整的多模态支持**，现在支持所有智谱AI官方提供的41个模型，并根据不同模型类型提供相应的功能适配。

---

## 🎯 主要更新内容

### 1. 📚 **完整的模型库支持（41个模型）**

#### 🌟 最新旗舰模型（6个）
- **GLM-4.6** - 3550亿参数MoE架构，200K上下文
- **GLM-4.5** - 最新旗舰，128K上下文
- **GLM-4.5-X** - 极速版，100 tokens/秒
- **GLM-4.5-Air** - 高性价比，支持混合思考
- **GLM-4.5-AirX** - 大规模高速版本
- **GLM-4.5-Flash** - 免费版本 💰

#### 🧠 推理专用模型（3个）
- **GLM-Z1-AirX** - 国内最快，200 tokens/秒
- **GLM-Z1-Air** - 数理逻辑推理优化
- **GLM-Z1-Flash** - 免费推理模型 💰

#### 👁️ 视觉理解模型（6个）
- **GLM-4.5V** - 最强视觉推理SOTA
- **GLM-4.1V-Thinking-Flash** - 10B级别最强视觉模型
- **GLM-4V-Plus** - 视频和多图片理解
- **GLM-4V-Plus-0111** - 可变分辨率支持
- **GLM-4V** - 图像理解
- **GLM-4V-Flash** - 免费图像理解 💰

#### 💬 GLM-4系列标准模型（10个）
- GLM-4-Plus, GLM-4-0520, GLM-4-Long (1M上下文)
- GLM-4-Air系列, GLM-4-Flash系列（免费）
- GLM-4-9B 开源模型等

#### 🤖 智能体与工具模型（2个）
- **GLM-4-AllTools** - Agent模型，128K上下文
- **GLM-4-Assistant** - 智能体应用

#### 💻 代码专用模型（1个）
- **CodeGeeX-4** - 代码生成，128K上下文

#### 🎨 图像生成模型（4个）
- CogView-4-250304, CogView-3-Plus
- CogView-3, CogView-3-Flash（免费）💰

#### 🎬 视频生成模型（4个）
- CogVideoX-3, CogVideoX-2
- CogVideoX, CogVideoX-Flash（免费）💰

#### 🔊 语音模型（1个）
- **GLM-4-Voice** - 端到端语音对话

#### 📊 向量与工具模型（3个）
- Embedding-3, Embedding-2, Rerank

#### 🔧 开源与经典模型（1个）
- ChatGLM3-6B - 60亿参数，可微调

---

### 2. 🖼️ **视觉模型图片上传功能**

#### 新增功能：
- ✅ 图片上传按钮（仅在选择视觉模型时显示）
- ✅ 多图片上传支持
- ✅ 图片预览功能
- ✅ 单张图片移除功能
- ✅ 图片大小限制（10MB）
- ✅ 图片格式验证

#### 支持的视觉模型：
- GLM-4.5V, GLM-4.1V-Thinking-Flash
- GLM-4V-Plus, GLM-4V-Plus-0111
- GLM-4V, GLM-4V-Flash

#### 使用方法：
1. 在设置中选择任一视觉模型
2. 点击输入框左侧的📷按钮上传图片
3. 可以上传多张图片
4. 输入文字描述（可选）
5. 点击发送，AI会分析图片内容

---

### 3. 🎨 **图像生成功能**

#### 支持的图像生成模型：
- CogView-4-250304 - 具备文字生成能力
- CogView-3-Plus - 高质量，多尺寸
- CogView-3 - 快速精准，1024x1024
- CogView-3-Flash - 免费 💰

#### 使用方法：
1. 选择任一CogView图像生成模型
2. 输入框提示会变为"描述你想生成的图片..."
3. 输入详细的图片描述
4. 点击发送，等待图片生成
5. 生成的图片会直接显示在对话中
6. 点击图片可在新窗口查看大图

---

### 4. 🎬 **视频生成功能（异步）**

#### 支持的视频生成模型：
- CogVideoX-3 - 全新视频生成
- CogVideoX-2 - 文本/图片生成视频
- CogVideoX - 文本/图片生成视频
- CogVideoX-Flash - 免费 💰

#### 使用方法：
1. 选择任一CogVideoX视频生成模型
2. 输入框提示会变为"描述你想生成的视频..."
3. 输入详细的视频描述
4. 点击发送，提交异步生成任务
5. 系统会返回任务ID
6. 视频生成需要几分钟时间，可稍后通过API查询结果

> 注意：视频生成是异步任务，需要使用智谱AI的"查询异步结果"API来获取最终视频。

---

### 5. 🔧 **智能模型类型识别**

系统会自动识别选择的模型类型，并提供相应功能：

| 模型类型 | 功能支持 | 输入框提示 |
|---------|---------|-----------|
| 对话模型 | 文本对话、流式输出 | "输入消息..." |
| 视觉模型 | 文本对话 + 图片上传 | "输入消息或上传图片..." |
| 图像生成 | 文本生成图片 | "描述你想生成的图片..." |
| 视频生成 | 文本生成视频（异步） | "描述你想生成的视频..." |
| 语音模型 | 语音对话（待扩展） | "输入消息..." |
| 向量/重排序 | 仅API调用 | 不支持对话界面 |

---

## 🎨 界面改进

### 1. **图片上传组件**
- 美观的图片预览卡片
- 每张图片都有删除按钮
- 响应式设计，移动端适配

### 2. **消息显示优化**
- 支持在消息中显示图片
- 图片可点击查看大图
- 图片采用网格布局

### 3. **模型选择器优化**
- 使用optgroup分组
- 每个模型都有详细描述
- 免费模型用💰标识
- 支持自定义模型名称

---

## 🔌 API端点配置

系统现在支持多个API端点：

```javascript
const API_ENDPOINTS = {
    CHAT: 'https://open.bigmodel.cn/api/paas/v4/chat/completions',
    IMAGE_GEN: 'https://open.bigmodel.cn/api/paas/v4/images/generations',
    VIDEO_GEN: 'https://open.bigmodel.cn/api/paas/v4/videos/generations',
    EMBEDDING: 'https://open.bigmodel.cn/api/paas/v4/embeddings',
    RERANK: 'https://open.bigmodel.cn/api/paas/v4/rerank'
};
```

---

## 📝 技术实现细节

### 1. **模型类型自动识别**
```javascript
function getModelType(modelName) {
    // 自动识别模型类型
    // 返回: CHAT, VISION, IMAGE_GEN, VIDEO_GEN等
}
```

### 2. **多模态消息格式**
```javascript
// 视觉模型的消息格式
{
    role: 'user',
    content: [
        { type: 'text', text: '这是什么？' },
        { type: 'image_url', image_url: { url: 'data:image/...' } }
    ]
}
```

### 3. **图片Base64编码**
- 上传的图片自动转换为Base64格式
- 直接发送给API，无需额外服务器存储

---

## 🚀 使用示例

### 示例1：使用视觉模型分析图片
1. 选择模型：GLM-4.5V
2. 点击📷按钮上传图片
3. 输入："请详细描述这张图片"
4. 发送，AI会分析图片并给出详细描述

### 示例2：生成图片
1. 选择模型：CogView-3-Plus
2. 输入："一只可爱的橙色小猫在阳光下睡觉，宫崎骏风格"
3. 发送，等待几秒
4. 图片生成完成，直接显示在对话中

### 示例3：生成视频
1. 选择模型：CogVideoX-3
2. 输入："一只蝴蝶在花园中飞舞，慢镜头"
3. 发送，获得任务ID
4. 使用API查询工具查询任务结果

---

## ⚠️ 注意事项

1. **图片大小限制**：单张图片不超过10MB
2. **API配额**：不同模型有不同的调用限制
3. **免费模型**：标记💰的模型为免费模型
4. **视频生成**：是异步任务，需要几分钟时间
5. **向量模型**：Embedding和Rerank模型不支持对话界面，需直接调用API

---

## 🔮 未来计划

- [ ] 添加语音输入输出功能（GLM-4-Voice）
- [ ] 添加异步任务查询界面
- [ ] 支持文件上传解析
- [ ] 添加批处理功能
- [ ] 集成知识库API
- [ ] 添加智能体对话功能

---

## 📚 参考文档

- [智谱AI官方文档](https://docs.bigmodel.cn/)
- [对话补全API](https://docs.bigmodel.cn/api-reference/模型-api/对话补全)
- [图像生成API](https://docs.bigmodel.cn/api-reference/模型-api/图像生成)
- [视频生成API](https://docs.bigmodel.cn/api-reference/模型-api/生成视频)

---

## 🎉 总结

本次更新使智谱AI对话工具成为一个**完整的多模态AI应用平台**，支持：
- ✅ 41个不同类型的模型
- ✅ 文本对话
- ✅ 视觉理解（图片分析）
- ✅ 图像生成
- ✅ 视频生成
- ✅ 流式输出
- ✅ 智能类型识别
- ✅ 响应式设计

所有功能都已完全集成到统一的界面中，根据选择的模型自动适配功能，提供最佳的用户体验！

---

**版本**: v2.0-Multimodal  
**更新日期**: 2025-10-12  
**作者**: AI Assistant

